app:
  description: æ‰¹é‡è¯†åˆ«å‘ç¥¨å¹¶ä¸€é”®å¯¼å‡ºExcel
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: å‘ç¥¨è¯†åˆ«åŠ©æ‰‹
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/siliconflow:0.0.20@a0297ff9ba92d57b12efa51dad87bbf68f6556979d2f32ed15fc833a3a1f4f39
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: kalochin/pdf_process:0.0.4@1fe29eabc04f0a11e79671d18adb8daa9b2ecc6dec6fdbc19e6825a15f7a236a
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1753084622669-source-1753085399938-target
      selected: false
      source: '1753084622669'
      sourceHandle: source
      target: '1753085399938'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1753085399938-source-1753085496874-target
      selected: false
      source: '1753085399938'
      sourceHandle: source
      target: '1753085496874'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1753084497988-source-17531506868760-target
      source: '1753084497988'
      sourceHandle: source
      target: '17531506868760'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 17531506868760-true-1753084622669-target
      source: '17531506868760'
      sourceHandle: 'true'
      target: '1753084622669'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 17531506868760-425ca04e-8a73-417c-acc0-df5944c3fdb0-17531506690560-target
      source: '17531506868760'
      sourceHandle: 425ca04e-8a73-417c-acc0-df5944c3fdb0
      target: '17531506690560'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: llm
      id: 17531506690560-source-1753084622669-target
      source: '17531506690560'
      sourceHandle: source
      target: '1753084622669'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - allowed_file_extensions: []
          allowed_file_types:
          - image
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: å‘ç¥¨æ–‡ä»¶
          max_length: 5
          options: []
          required: true
          type: file-list
          variable: upload
      height: 90
      id: '1753084497988'
      position:
        x: -52.620391714865036
        y: 282
      positionAbsolute:
        x: -52.620391714865036
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-VL-72B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: 909ef2d2-3080-48b6-bc52-2e399ed7bc9e
          role: system
          text: '# è§’è‰²

            ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å‘ç¥¨ä¿¡æ¯æå–åŠ©æ‰‹ã€‚


            # ä»»åŠ¡

            ä½ çš„ä»»åŠ¡æ˜¯ä»å›¾ç‰‡ä¸­ï¼Œç²¾å‡†åœ°æå–æ‰€æœ‰å…³é”®ä¿¡æ¯ï¼Œå¹¶ä¸¥æ ¼æŒ‰ç…§æŒ‡å®šçš„ JSON æ ¼å¼è¾“å‡ºã€‚è¯·å¿½ç•¥æ–‡æœ¬ä¸­ä¸å‘ç¥¨æ— å…³çš„å¹²æ‰°é¡¹ï¼ˆå¦‚â€œä¸‹è½½æ¬¡æ•°â€ï¼‰ã€‚


            # è¾“å…¥å˜é‡

            å‘ç¥¨çš„åŸå§‹æ–‡æœ¬å†…å®¹å°†é€šè¿‡å›¾ç‰‡è¯†åˆ«çš„å†…å®¹ä¼ å…¥ã€‚


            # è¾“å‡ºè¦æ±‚

            1.**ä¸¥æ ¼çš„JSONæ ¼å¼**ï¼šä½ çš„å›ç­”å¿…é¡»æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€æ ¼å¼æ­£ç¡®çš„ JSON å¯¹è±¡ï¼Œä¸èƒ½åŒ…å«ä»»ä½• JSON ä¹‹å¤–çš„è§£é‡Šã€æ³¨é‡Šæˆ–æ–‡å­—ã€‚

            2.**æ•°æ®æ¸…æ´—**ï¼š

            Â  Â  *Â å¯¹äºé‡‘é¢å’Œæ•°é‡ï¼Œåªä¿ç•™æ•°å­—ï¼Œå»é™¤è´§å¸ç¬¦å·ï¼ˆå¦‚Â `Â¥`ï¼‰ã€‚

            Â  Â  *Â å¯¹äºæ—¥æœŸï¼Œç»Ÿä¸€è¾“å‡ºä¸ºÂ `YYYY-MM-DD`Â æ ¼å¼ã€‚

            Â  Â  *Â å¯¹äºç¨ç‡ï¼Œè¾“å‡ºç™¾åˆ†æ¯”å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚Â `"13%"`ã€‚

            Â  Â  *Â å¦‚æœæŸä¸€é¡¹ä¿¡æ¯åœ¨å‘ç¥¨ä¸­ä¸å­˜åœ¨ï¼Œè¯·ä½¿ç”¨Â `null`Â æˆ–è€…ç©ºå­—ç¬¦ä¸²Â `""`Â ä½œä¸ºå€¼ã€‚

            3.**å¤„ç†é¡¹ç›®åˆ—è¡¨**ï¼šå‘ç¥¨ä¸­çš„â€œé¡¹ç›®åç§°â€éƒ¨åˆ†å¯èƒ½åŒ…å«å¤šä¸ªå•†å“æˆ–æœåŠ¡ï¼Œç”šè‡³å¯èƒ½åŒ…å«æŠ˜æ‰£ï¼ˆé‡‘é¢ä¸ºè´Ÿæ•°ï¼‰ã€‚ä½ éœ€è¦å°†æ¯ä¸€ä¸ªé¡¹ç›®éƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œæ”¾å…¥Â `items`Â æ•°ç»„ä¸­ã€‚


            # JSON è¾“å‡ºæ ¼å¼

            ```json

            {

            Â  "invoice_title": "string",

            Â  "invoice_number": "string",

            Â  "issue_date": "string",

            Â  "buyer_info": {

            Â  Â  "name": "string",

            Â  Â  "tax_id": "string"

            Â  },

            Â  "seller_info": {

            Â  Â  "name": "string",

            Â  Â  "tax_id": "string"

            Â  },

            Â  "items": [

            Â  Â  {

            Â  Â  Â  "name": "string",

            Â  Â  Â  "model": "string",

            Â  Â  Â  "unit": "string",

            Â  Â  Â  "quantity": "number | null",

            Â  Â  Â  "unit_price": "number | null",

            Â  Â  Â  "amount": "number",

            Â  Â  Â  "tax_rate": "string",

            Â  Â  Â  "tax_amount": "number"

            Â  Â  }

            Â  ],

            Â  "total_amount_exclusive_tax": "number",

            Â  "total_tax_amount": "number",

            Â  "total_amount_inclusive_tax": {

            Â  Â  "in_words": "string",

            Â  Â  "in_figures": "number"

            Â  },

            Â  "remarks": "string",

            Â  "issuer": "string"

            }

            '
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          configs:
            detail: high
            variable_selector:
            - '17531506690560'
            - files
          enabled: true
      height: 90
      id: '1753084622669'
      position:
        x: 924.7202690824474
        y: 309.09448862991866
      positionAbsolute:
        x: 924.7202690824474
        y: 309.09448862991866
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nimport re\n\ndef main(output: str) -> dict:\n    # å»é™¤\
          \ markdown ä»£ç å—æ ‡è®°\n    output = re.sub(r\"^```[\\w]*\\s*\", \"\", output.strip(),\
          \ flags=re.IGNORECASE)\n    output = re.sub(r\"```$\", \"\", output.strip())\n\
          \    output = output.strip()\n\n    try:\n        data = json.loads(output)\n\
          \    except json.JSONDecodeError as e:\n        print(f\"JSON è§£æé”™è¯¯: {e}\"\
          )\n        return {\"result\": {}}\n    \n    # å¤„ç†æ—¥æœŸæ ¼å¼\n    date_str = data.get(\"\
          issue_date\", \"\").replace(\"/\", \"-\").replace(\".\", \"-\").strip()\n\
          \    \n    # å¤„ç†å•†å“åˆ—è¡¨\n    items_str = json.dumps(data.get(\"items\", []),\
          \ ensure_ascii=False)\n    \n    # æ„å»ºè®°å½•å­—å…¸\n    record = {\n        \"invoice_title\"\
          : data.get(\"invoice_title\", \"\"),\n        \"invoice_code\": data.get(\"\
          invoice_number\", \"\"),\n        \"issue_date\": date_str,\n        \"\
          buyer_name\": data.get(\"buyer_info\", {}).get(\"name\", \"\"),\n      \
          \  \"buyer_tax_id\": data.get(\"buyer_info\", {}).get(\"tax_id\", \"\"),\n\
          \        \"seller_name\": data.get(\"seller_info\", {}).get(\"name\", \"\
          \"),\n        \"seller_tax_id\": data.get(\"seller_info\", {}).get(\"tax_id\"\
          , \"\"),\n        \"items\": items_str,\n        \"total_amount\": data.get(\"\
          total_amount_exclusive_tax\", \"\"),\n        \"total_tax\": data.get(\"\
          total_tax_amount\", \"\"),\n        \"total_with_tax\": data.get(\"total_amount_inclusive_tax\"\
          , {}).get(\"in_figures\", \"\"),\n        \"total_with_tax_in_words\": data.get(\"\
          total_amount_inclusive_tax\", {}).get(\"in_words\", \"\"),\n        \"remarks\"\
          : data.get(\"remarks\", \"\"),\n        \"issuer\": data.get(\"issuer\"\
          , \"\")\n    }\n    \n    return {\"result\": record}\n\n# æ·»åŠ ä¸»ç¨‹åºå…¥å£\nif __name__\
          \ == \"__main__\":\n    # ç¤ºä¾‹è¾“å…¥ï¼ˆéœ€è¦æ˜¯æœ‰æ•ˆçš„ JSON å­—ç¬¦ä¸²ï¼‰\n    sample_input = \"\"\
          \"\n    {\n        \"invoice_title\": \"æµ‹è¯•å‘ç¥¨\",\n        \"invoice_number\"\
          : \"12345678\",\n        \"issue_date\": \"2023/01/01\",\n        \"buyer_info\"\
          : {\n            \"name\": \"ä¹°æ–¹åç§°\",\n            \"tax_id\": \"1234567890\"\
          \n        },\n        \"seller_info\": {\n            \"name\": \"å–æ–¹åç§°\"\
          ,\n            \"tax_id\": \"0987654321\"\n        },\n        \"items\"\
          : [\n            {\"name\": \"å•†å“1\", \"quantity\": 1, \"price\": 100}\n\
          \        ],\n        \"total_amount_exclusive_tax\": \"100.00\",\n     \
          \   \"total_tax_amount\": \"13.00\",\n        \"total_amount_inclusive_tax\"\
          : {\n            \"in_figures\": \"113.00\",\n            \"in_words\":\
          \ \"å£¹ä½°å£¹æ‹¾åå…ƒæ•´\"\n        },\n        \"remarks\": \"å¤‡æ³¨ä¿¡æ¯\",\n        \"issuer\"\
          : \"å¼€ç¥¨äºº\"\n    }\n    \"\"\"\n    \n    result = main(sample_input)\n  \
          \  print(json.dumps(result, ensure_ascii=False, indent=2))"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: object
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - '1753084622669'
          - text
          value_type: string
          variable: output
      height: 54
      id: '1753085399938'
      position:
        x: 1223.016166212991
        y: 309.09448862991866
      positionAbsolute:
        x: 1223.016166212991
        y: 309.09448862991866
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1753085399938'
          - result
          value_type: object
          variable: result
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1753085496874'
      position:
        x: 1522.7380890608986
        y: 309.09448862991866
      positionAbsolute:
        x: 1522.7380890608986
        y: 309.09448862991866
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: PDF file to convert to PNG images
            ja_JP: PDF file to convert to PNG images
            pt_BR: PDF file to convert to PNG images
            zh_Hans: è¦è½¬æ¢ä¸ºPNGå›¾ç‰‡çš„PDFæ–‡ä»¶
          label:
            en_US: PDF Content
            ja_JP: PDF Content
            pt_BR: PDF Content
            zh_Hans: PDF å†…å®¹
          llm_description: PDF file content to be converted to PNG images
          max: null
          min: null
          name: pdf_content
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: file
        - auto_generate: null
          default: 2
          form: llm
          human_description:
            en_US: Zoom factor for image quality (default is 2)
            ja_JP: Zoom factor for image quality (default is 2)
            pt_BR: Zoom factor for image quality (default is 2)
            zh_Hans: å›¾åƒè´¨é‡çš„ç¼©æ”¾å› å­ï¼ˆé»˜è®¤ä¸º2ï¼‰
          label:
            en_US: Zoom Factor
            ja_JP: Zoom Factor
            pt_BR: Zoom Factor
            zh_Hans: ç¼©æ”¾å› å­
          llm_description: Zoom factor to control the quality of output PNG images
          max: null
          min: null
          name: zoom
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: number
        params:
          pdf_content: ''
          zoom: ''
        provider_id: kalochin/pdf_process/pdf_process
        provider_name: kalochin/pdf_process/pdf_process
        provider_type: builtin
        selected: false
        title: PDFè½¬PNGè½¬æ¢å™¨ (1)
        tool_configurations: {}
        tool_description: ä¸€ä¸ªå°†PDFæ–‡ä»¶è½¬æ¢ä¸ºPNGå›¾ç‰‡çš„å·¥å…·
        tool_label: PDFè½¬PNGè½¬æ¢å™¨
        tool_name: pdf_to_png
        tool_parameters:
          pdf_content:
            type: variable
            value:
            - '1753084497988'
            - upload
          zoom:
            type: constant
            value: 2
        type: tool
        version: '2'
      height: 86
      id: '17531506690560'
      position:
        x: 584.6521229287074
        y: 385.4554271301072
      positionAbsolute:
        x: 584.6521229287074
        y: 385.4554271301072
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 4a2607f7-9d5f-41c2-a550-570a00f54d65
            sub_variable_condition:
              case_id: 6728bed9-b07c-4ed3-9d3a-40e919e25aca
              conditions:
              - comparison_operator: in
                id: 50cb0d89-5f46-42d1-bcaa-994922873d28
                key: type
                value:
                - image
                varType: string
              logical_operator: and
            value: ''
            varType: array[file]
            variable_selector:
            - '1753084497988'
            - upload
          id: 'true'
          logical_operator: and
        - case_id: 425ca04e-8a73-417c-acc0-df5944c3fdb0
          conditions:
          - comparison_operator: contains
            id: e3f3869f-cda9-4116-b216-579d9f15d180
            sub_variable_condition:
              case_id: 466a52bb-6247-4137-80a2-332f5f6be840
              conditions:
              - comparison_operator: in
                id: 72eb5eb2-15e5-4503-a166-c31fca336e6c
                key: type
                value:
                - document
                varType: string
              logical_operator: and
            value: ''
            varType: array[file]
            variable_selector:
            - '1753084497988'
            - upload
          id: 425ca04e-8a73-417c-acc0-df5944c3fdb0
          logical_operator: and
        desc: ''
        selected: false
        title: æ–‡ä»¶ç±»å‹
        type: if-else
      height: 222
      id: '17531506868760'
      position:
        x: 303.7250566079716
        y: 282
      positionAbsolute:
        x: 303.7250566079716
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -730.233707894814
      y: 113.08932073567709
      zoom: 0.694477567882555
